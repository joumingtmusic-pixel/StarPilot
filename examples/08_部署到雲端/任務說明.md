# 🚀 部署到雲端 - 讓全世界都能用你的工具

> **讓你的作品上線！** 從本地開發到雲端部署，讓同事、朋友都能直接使用

---

## 📖 為什麼要學部署？

你已經用 AI 做出了很多實用工具：
- 📊 數據分析儀表板
- 📁 檔案整理工具
- 🕷️ 網頁資料爬蟲
- 📈 自動化報表

但這些工具現在只能在 Codespaces 中執行，**只有你自己能用**。

學會部署後：
- ✅ 同事可以直接開網頁使用
- ✅ 不需要安裝任何軟體
- ✅ 24/7 持續運行
- ✅ 自動更新（你改程式碼，網站自動更新）

---

## 🎯 學習目標

完成本章節後，你將學會：
1. 將 Streamlit 應用部署到 Streamlit Cloud（**最簡單**）
2. 將任何 Python 應用部署到 Render（**更靈活**）
3. 設定自動部署（push 到 GitHub 就自動更新）
4. 管理環境變數和設定檔

---

## 📋 課程大綱

### 🥇 階段一：部署你的第一個 Streamlit 應用

**時間**：20-30 分鐘  
**難度**：⭐（超級簡單）

**你會學到**：
- 註冊 Streamlit Cloud
- 連結 GitHub 專案
- 3 步驟完成部署
- 分享網址給同事

**範例專案**：銷售數據分析儀表板

---

### 🥈 階段二：部署更複雜的應用到 Render

**時間**：30-40 分鐘  
**難度**：⭐⭐

**你會學到**：
- 註冊 Render
- 設定啟動指令
- 環境變數管理
- 查看執行日誌

**範例專案**：自動化爬蟲 + 每日更新

---

### 🥉 階段三：設定自動部署流程

**時間**：15-20 分鐘  
**難度**：⭐

**你會學到**：
- GitHub 自動部署設定
- 修改程式碼自動更新
- 版本回溯

---

## 🎮 實戰演練

### 任務 1：部署銷售數據儀表板（Streamlit Cloud）

**情境**：
你做了一個銷售數據分析工具，主管希望每天都能查看最新數據。

**步驟**：

#### 1️⃣ 準備你的專案

首先，確認你的專案有以下檔案：

```
your_project/
├── app.py                 # 主程式
├── requirements.txt       # 套件清單
└── data/                  # 資料檔案（選用）
    └── sales.csv
```

**對話範例**：

```
👤：我想做一個銷售數據儀表板
    顯示每月銷售額、前五名產品、趨勢圖
    使用 data/sales.csv 的資料

🤖：好的！我會用 Streamlit 建立互動式儀表板
    包含：
    1. 每月銷售額統計
    2. 產品排行榜
    3. 銷售趨勢圖
    
    正在生成 app.py...
    [完成] 要執行看看嗎？

👤：執行！

🤖：[開啟瀏覽器] http://localhost:8501
    儀表板已啟動！

👤：很好！幫我生成 requirements.txt

🤖：已建立 requirements.txt，包含：
    streamlit
    pandas
    plotly
    openpyxl
```

---

#### 2️⃣ 推送到 GitHub

```
👤：幫我把這個專案推送到 GitHub

🤖：我會協助你完成 Git 操作：
    1. 初始化 Git 倉庫
    2. 建立 .gitignore（忽略不必要的檔案）
    3. Commit 所有檔案
    4. 推送到 GitHub
    
    請問你的 GitHub 專案網址是？

👤：https://github.com/你的帳號/sales-dashboard

🤖：了解！正在推送...
    [完成] 程式碼已上傳到 GitHub
```

> 💡 **提示**：如果還沒建立 GitHub 專案，可以在 GitHub 網站上點擊「New repository」

---

#### 3️⃣ 部署到 Streamlit Cloud

**步驟說明**（用瀏覽器操作）：

1. **前往 Streamlit Cloud**
   - 開啟：https://streamlit.io/cloud
   - 點擊「Sign up」或「Sign in with GitHub」

2. **授權 GitHub**
   - 選擇「Authorize Streamlit」
   - （第一次使用需要授權）

3. **新增應用**
   - 點擊「New app」
   - 選擇你的 GitHub 專案：`你的帳號/sales-dashboard`
   - 主檔案：`app.py`
   - 點擊「Deploy!」

4. **等待部署**
   - 畫面會顯示部署進度
   - 約 2-3 分鐘完成
   - 會自動開啟你的應用！

5. **分享網址**
   - 你的應用網址會是：`https://你的帳號-sales-dashboard.streamlit.app`
   - 複製網址分享給同事即可！

---

#### ✅ 完成檢查

- [ ] 應用可以正常開啟
- [ ] 資料正確顯示
- [ ] 圖表互動正常
- [ ] 同事可以透過網址存取

---

### 任務 2：部署自動化工具到 Render

**情境**：
你做了一個每天自動抓取競品價格的爬蟲工具，需要 24/7 運行。

**步驟**：

#### 1️⃣ 準備專案檔案

確認你的專案有：

```
price_monitor/
├── app.py                 # 主程式（Flask API）
├── scraper.py             # 爬蟲邏輯
├── requirements.txt       # 套件清單
└── README.md              # 說明文件
```

**對話範例**：

```
👤：我想做一個價格監控工具
    每小時抓取三個競品網站的價格
    提供 API 讓其他人查詢最新價格

🤖：好的！我會建立：
    1. Flask API（提供查詢端點）
    2. 爬蟲模組（抓取價格）
    3. 排程任務（每小時執行）
    
    正在生成...
    [完成] 本地測試指令：python app.py

👤：測試成功！幫我準備部署到 Render

🤖：我會建立部署所需的檔案：
    1. requirements.txt（已更新）
    2. render.yaml（部署設定）
    3. .gitignore（忽略敏感檔案）
    
    [完成] 可以推送到 GitHub 了
```

---

#### 2️⃣ 推送到 GitHub

```
👤：推送到 GitHub

🤖：正在執行 Git 操作...
    [完成] 已推送到 https://github.com/你的帳號/price-monitor
```

---

#### 3️⃣ 部署到 Render

**步驟說明**：

1. **註冊 Render**
   - 前往：https://render.com
   - 點擊「Get Started」
   - 選擇「Sign in with GitHub」

2. **建立新服務**
   - 點擊「New +」→「Web Service」
   - 選擇你的 GitHub 專案：`price-monitor`
   - 點擊「Connect」

3. **設定服務**
   - **Name**：`price-monitor`（服務名稱）
   - **Environment**：`Python 3`
   - **Build Command**：`pip install -r requirements.txt`
   - **Start Command**：`python app.py`
   - **Plan**：選擇「Free」

4. **新增環境變數**（如果需要）
   - 點擊「Add Environment Variable」
   - 例如：
     - Key: `API_KEY`
     - Value: `你的API金鑰`

5. **部署**
   - 點擊「Create Web Service」
   - 等待 3-5 分鐘
   - 部署完成後會顯示網址：`https://price-monitor.onrender.com`

---

#### ✅ 完成檢查

- [ ] API 端點可以正常存取
- [ ] 排程任務正常運行
- [ ] 日誌沒有錯誤訊息
- [ ] 環境變數設定正確

---

### 任務 3：設定自動部署

**目標**：修改程式碼後，自動更新到雲端

**好消息**：Streamlit Cloud 和 Render 都**預設支援自動部署**！

**運作方式**：

```
你修改程式碼 → Push 到 GitHub → 雲端平台自動偵測 → 自動重新部署
```

**測試自動部署**：

```
👤：我想在儀表板加上「匯出 Excel」功能

🤖：好的！我會在 app.py 加上匯出按鈕
    [完成] 要測試看看嗎？

👤：本地測試成功！推送到 GitHub

🤖：正在推送...
    [完成] Streamlit Cloud 會在 1-2 分鐘內自動更新
    
    你可以到 Streamlit Cloud 後台查看部署進度：
    https://streamlit.io/cloud
```

**查看部署狀態**：
1. 前往平台後台（Streamlit Cloud 或 Render）
2. 找到你的應用
3. 查看「Deployments」或「Logs」頁籤
4. 確認最新版本已部署

---

## 🎯 進階技巧

### 1. 環境變數管理（隱藏敏感資訊）

**情境**：你的爬蟲需要 API 金鑰，不想寫在程式碼裡

**Streamlit Cloud 設定**：
1. 前往應用設定 → Settings → Secrets
2. 新增 TOML 格式的設定：
   ```toml
   API_KEY = "your_secret_key"
   DATABASE_URL = "postgresql://..."
   ```

**在程式中使用**：
```python
import streamlit as st

api_key = st.secrets["API_KEY"]
```

**Render 設定**：
1. 應用設定 → Environment
2. 新增 Key-Value：
   - Key: `API_KEY`
   - Value: `your_secret_key`

**在程式中使用**：
```python
import os

api_key = os.getenv("API_KEY")
```

---

### 2. 自訂網域名稱

**Streamlit Cloud**：
- 預設：`你的帳號-專案名稱.streamlit.app`
- 付費方案可自訂網域

**Render**：
- 免費方案：`專案名稱.onrender.com`
- 付費方案可自訂網域（例如：`dashboard.yourcompany.com`）

---

### 3. 查看執行日誌（除錯用）

**如果部署後無法正常運作**：

1. **Streamlit Cloud**：
   - 應用頁面右下角 → 「Manage app」 → 「Logs」
   - 查看錯誤訊息

2. **Render**：
   - 應用頁面 → 「Logs」頁籤
   - 即時顯示執行日誌

**常見錯誤**：
- ❌ `ModuleNotFoundError`：套件沒有加到 `requirements.txt`
- ❌ `FileNotFoundError`：檔案路徑錯誤（部署後路徑可能不同）
- ❌ `Port already in use`：Render 會自動設定 PORT，不要寫死

---

## 📊 平台比較

| 功能 | Streamlit Cloud | Render |
|------|----------------|--------|
| **適合應用** | Streamlit 儀表板 | 任何 Python 應用 |
| **免費額度** | 無限制 | 750 小時/月 |
| **部署速度** | 1-2 分鐘 | 3-5 分鐘 |
| **自動部署** | ✅ | ✅ |
| **自訂網域** | 付費 | 付費 |
| **資料庫** | ❌ | ✅（PostgreSQL） |
| **背景任務** | ❌ | ✅ |
| **環境變數** | ✅ | ✅ |
| **推薦給** | 數據分析、報表 | 爬蟲、API、排程 |

---

## 💡 常見問題

### Q1: 部署後應用很慢？

**Streamlit Cloud**：
- 免費方案資源有限，尖峰時段可能較慢
- 優化建議：減少資料處理量、使用快取

**Render**：
- 免費方案在閒置 15 分鐘後會休眠
- 第一次存取需要 30-60 秒啟動
- 付費方案可保持 24/7 運行

---

### Q2: 可以部署需要登入的應用嗎？

**可以！** 兩個平台都支援身份驗證：

**Streamlit**：使用內建的密碼保護
```python
import streamlit as st

def check_password():
    if st.session_state.get("password_correct", False):
        return True
    
    password = st.text_input("請輸入密碼", type="password")
    if st.button("登入"):
        if password == st.secrets["PASSWORD"]:
            st.session_state["password_correct"] = True
            st.rerun()
        else:
            st.error("密碼錯誤")
    return False

if check_password():
    st.write("歡迎使用儀表板！")
```

---

### Q3: 如何回溯到舊版本？

**Streamlit Cloud**：
1. 前往應用設定
2. 選擇「Reboot」或指定 Git commit

**Render**：
1. 前往「Deployments」
2. 選擇舊版本
3. 點擊「Redeploy」

---

### Q4: 部署費用會很貴嗎？

**完全不會！免費方案已經非常夠用：**

- **Streamlit Cloud**：無限制使用
- **Render**：750 小時/月（約 31 天不間斷）

只有當你需要更多資源或自訂網域時，才需要付費。

---

## 🎯 挑戰任務

完成以上教學後，試試這些挑戰：

### 🥇 初級挑戰
- [ ] 部署一個簡單的 BMI 計算器
- [ ] 分享網址給 3 位朋友測試

### 🥈 中級挑戰
- [ ] 部署一個檔案格式轉換工具（PDF → Word）
- [ ] 加上密碼保護

### 🥉 高級挑戰
- [ ] 部署一個每日自動執行的爬蟲
- [ ] 結果儲存到資料庫
- [ ] 建立 API 讓其他人查詢

---

## 🌟 恭喜你！

完成本章節後，你已經掌握：
- ✅ 雲端部署的完整流程
- ✅ 讓作品被全世界使用
- ✅ 自動化部署和更新
- ✅ 環境變數和設定管理

**你現在可以**：
- 把所有實用工具部署上線
- 分享給同事、朋友使用
- 在履歷上寫「具備雲端部署經驗」

---

## 📚 延伸學習

- [Streamlit Cloud 官方文件](https://docs.streamlit.io/streamlit-community-cloud)
- [Render 官方文件](https://render.com/docs)
- [GitHub Actions 自動化](https://docs.github.com/en/actions)（更進階的 CI/CD）

---

**接下來的目標**：在工作中找一個重複性任務，自動化它，然後部署上線給團隊使用！🚀
